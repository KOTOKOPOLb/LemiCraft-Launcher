<Window x:Class="LemiCraft_Launcher.Windows.NewsDetailWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Новость"
        Height="700"
        Width="800"
        WindowStyle="None"
        ResizeMode="NoResize"
        Background="Transparent"
        AllowsTransparency="True"
        WindowStartupLocation="CenterOwner">

    <Window.Resources>
        <Style x:Key="NewsScrollBar" TargetType="ScrollBar">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Width" Value="4"/>
            <Setter Property="Margin" Value="0,8,6,8"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ScrollBar">
                        <Grid>
                            <Border Background="Transparent" CornerRadius="2"/>
                            <Track x:Name="PART_Track" IsDirectionReversed="True">
                                <Track.Thumb>
                                    <Thumb>
                                        <Thumb.Template>
                                            <ControlTemplate>
                                                <Border Background="#4A5568" CornerRadius="2"/>
                                            </ControlTemplate>
                                        </Thumb.Template>
                                    </Thumb>
                                </Track.Thumb>
                            </Track>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Border x:Name="RootBorder"
            Background="#0F172A"
            CornerRadius="16"
            BorderBrush="#374151"
            BorderThickness="1"
            RenderTransformOrigin="0.5,0.5"
            ClipToBounds="True">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <Border Grid.Row="0"
                    Background="#1E293B"
                    CornerRadius="16,16,0,0"
                    MouseLeftButtonDown="TitleBar_MouseDown">
                <Grid Margin="20,0" Height="52" VerticalAlignment="Center">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <Border Grid.Column="0"
                            Width="8" Height="8"
                            CornerRadius="4"
                            Background="#3B82F6"
                            VerticalAlignment="Center"
                            Margin="0,0,10,0"/>

                    <TextBlock Grid.Column="1"
                               Text="Новость"
                               FontSize="14"
                               FontWeight="SemiBold"
                               Foreground="#CBD5E1"
                               VerticalAlignment="Center"/>

                    <Button Grid.Column="2"
                            x:Name="CloseButton"
                            Width="28" Height="28"
                            VerticalAlignment="Center"
                            Cursor="Hand"
                            Click="CloseButton_Click"
                            Background="Transparent"
                            BorderThickness="0">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border x:Name="border"
                                        Background="Transparent"
                                        CornerRadius="6"
                                        Width="28" Height="28">
                                    <Path Data="M6,6 L22,22 M22,6 L6,22"
                                          Width="16"
                                          Height="16"
                                          Stretch="Uniform"
                                          Stroke="#94A3B8"
                                          StrokeThickness="1.8"
                                          StrokeStartLineCap="Round"
                                          StrokeEndLineCap="Round"
                                          HorizontalAlignment="Center"
                                          VerticalAlignment="Center"
                                          x:Name="xPath"/>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter TargetName="border" Property="Background" Value="#374151"/>
                                        <Setter TargetName="xPath" Property="Stroke" Value="White"/>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Button.Template>
                    </Button>
                </Grid>
            </Border>

            <Grid Grid.Row="1" ClipToBounds="True">
                <ScrollViewer x:Name="DetailScrollViewer"
                              VerticalScrollBarVisibility="Auto"
                              HorizontalScrollBarVisibility="Disabled"
                              ScrollChanged="DetailScrollViewer_ScrollChanged"
                              PreviewMouseWheel="DetailScrollViewer_PreviewMouseWheel"
                              Padding="0">
                    <ScrollViewer.Resources>
                        <Style TargetType="ScrollBar" BasedOn="{StaticResource NewsScrollBar}"/>
                    </ScrollViewer.Resources>

                    <StackPanel Margin="28,20,20,32">

                        <Border x:Name="ImageContainer"
                                Height="300"
                                CornerRadius="12"
                                Margin="0,0,0,20"
                                Visibility="Collapsed"
                                ClipToBounds="True">
                            <Grid>
                                <Image x:Name="NewsImage"
                                       Stretch="UniformToFill"
                                       HorizontalAlignment="Center"
                                       VerticalAlignment="Center"
                                       RenderOptions.BitmapScalingMode="HighQuality"/>
                                <Rectangle VerticalAlignment="Bottom"
                                           Height="80"
                                           IsHitTestVisible="False">
                                    <Rectangle.Fill>
                                        <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                            <GradientStop Color="#000F172A" Offset="0"/>
                                            <GradientStop Color="#AA0F172A" Offset="1"/>
                                        </LinearGradientBrush>
                                    </Rectangle.Fill>
                                </Rectangle>
                            </Grid>
                        </Border>

                        <Grid Margin="0,0,0,14">
                            <Border x:Name="CategoryBadge"
                                    Background="#22C55E"
                                    CornerRadius="6"
                                    Padding="10,5"
                                    HorizontalAlignment="Left">
                                <TextBlock x:Name="CategoryText"
                                           Text="Общее"
                                           FontSize="11"
                                           FontWeight="Bold"
                                           Foreground="White"/>
                            </Border>

                            <TextBlock x:Name="DateText"
                                       Text="01.01.2024"
                                       FontSize="12"
                                       Foreground="#64748B"
                                       HorizontalAlignment="Right"
                                       VerticalAlignment="Center"/>
                        </Grid>

                        <TextBlock x:Name="TitleText"
                                   Text="Заголовок новости"
                                   FontSize="24"
                                   FontWeight="Bold"
                                   Foreground="White"
                                   TextWrapping="Wrap"
                                   LineHeight="34"
                                   Margin="0,0,0,20"/>

                        <FlowDocumentScrollViewer x:Name="MarkdownViewer"
                                                  VerticalScrollBarVisibility="Disabled"
                                                  Background="Transparent"
                                                  BorderThickness="0"
                                                  IsToolBarVisible="False"
                                                  Focusable="False"
                                                  IsHitTestVisible="False"
                                                  Cursor="Arrow"
                                                  Margin="0,0,0,20"
                                                  PreviewMouseWheel="MarkdownViewer_PreviewMouseWheel">
                            <FlowDocument x:Name="MarkdownDocument"
                                          Background="Transparent"
                                          PagePadding="0"
                                          FontFamily="Segoe UI, Arial"
                                          FontSize="14"
                                          Foreground="#E5E7EB"
                                          LineHeight="24"/>
                        </FlowDocumentScrollViewer>

                        <Border Height="1"
                                Background="#1E293B"
                                Margin="0,0,0,16"/>

                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <StackPanel Orientation="Horizontal"
                                        Grid.Column="0"
                                        VerticalAlignment="Center">
                                <Border Width="36"
                                        Height="36"
                                        CornerRadius="18"
                                        Margin="0,0,10,0">
                                    <Border.Clip>
                                        <EllipseGeometry Center="18,18" RadiusX="18" RadiusY="18"/>
                                    </Border.Clip>
                                    <Image x:Name="AuthorAvatar"
                                           Stretch="UniformToFill"
                                           RenderOptions.BitmapScalingMode="HighQuality"/>
                                </Border>

                                <StackPanel VerticalAlignment="Center">
                                    <TextBlock x:Name="AuthorText"
                                               Text="Автор"
                                               FontSize="13"
                                               FontWeight="SemiBold"
                                               Foreground="White"/>
                                    <TextBlock Text="Администратор"
                                               FontSize="11"
                                               Foreground="#64748B"
                                               Margin="0,1,0,0"/>
                                </StackPanel>
                            </StackPanel>

                            <Button Grid.Column="1"
                                    Content="Открыть в Discord"
                                    Height="42"
                                    MinWidth="190"
                                    Padding="22,0"
                                    Background="#5865F2"
                                    Foreground="White"
                                    BorderThickness="0"
                                    FontSize="13"
                                    FontWeight="SemiBold"
                                    Cursor="Hand"
                                    Click="OpenDiscord_Click">
                                <Button.Template>
                                    <ControlTemplate TargetType="Button">
                                        <Border x:Name="border"
                                                Background="{TemplateBinding Background}"
                                                CornerRadius="8">
                                            <ContentPresenter HorizontalAlignment="Center"
                                                              VerticalAlignment="Center"/>
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter TargetName="border" Property="Background" Value="#4752C4"/>
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Button.Template>
                            </Button>
                        </Grid>
                    </StackPanel>
                </ScrollViewer>

                <Border x:Name="TopFade"
                        VerticalAlignment="Top"
                        Height="32"
                        Opacity="0"
                        IsHitTestVisible="False">
                    <Border.Background>
                        <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                            <GradientStop Color="#FF0F172A" Offset="0"/>
                            <GradientStop Color="#000F172A" Offset="1"/>
                        </LinearGradientBrush>
                    </Border.Background>
                </Border>

                <Border x:Name="BottomFade"
                        VerticalAlignment="Bottom"
                        Height="32"
                        Opacity="0"
                        IsHitTestVisible="False"
                        CornerRadius="0,0,16,16"
                        HorizontalAlignment="Stretch"
                        Margin="0">
                    <Border.Background>
                        <LinearGradientBrush StartPoint="0,1" EndPoint="0,0">
                            <GradientStop Color="#FF0F172A" Offset="0"/>
                            <GradientStop Color="#000F172A" Offset="1"/>
                        </LinearGradientBrush>
                    </Border.Background>
                </Border>
            </Grid>
        </Grid>
    </Border>
</Window>
